<!DOCTYPE html>
<html>
  <head>
    <title>David Mattia blog</title>
  </head>
  <body>
    <h2>David Mattia Blogs</h2>
    <button id="addBlog">Add Blog</button>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.5/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAy_f8zf5XP22SL-DLRKCmx3Vc_6zuDByc",
        authDomain: "blog-1a3a2.firebaseapp.com",
        databaseURL: "https://blog-1a3a2.firebaseio.com",
        storageBucket: "blog-1a3a2.appspot.com",
        messagingSenderId: "167923221156"
      };
      firebase.initializeApp(config);

      var database = firebase.database();

      function addBlog(title, content) {
        firebase.database().ref('blogs/').push({
          title: title,
          content: content,
        });
      }

      function addBlogPostToPage(values) {
        $('body').append(
          '<h2 class="blogTitle">' + values.title + '</h2>' +
          '<p class="blogContent">' + values.content + '</p>' + 
          '<hr>'
        );
      }

      // watch for new blogs
      var ref = firebase.database().ref('blogs/');
      ref.on('child_added', function(snapshot) {
        addBlogPostToPage(snapshot.val());  
      });

      $("#addBlog").on('click', function(e) {
        var email = prompt("email");
        var password = prompt("password");

        firebase.auth().signInWithEmailAndPassword(email, password)
          .then(function() {
            var title = prompt("title");
            var content = prompt("content");
            addBlog(title, content);
          })
          .catch(function(error) {
            alert(error.message);
          });
      });
    </script>
  </body>
</html>
